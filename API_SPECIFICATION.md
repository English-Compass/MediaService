# Media Recommendation Service API ëª…ì„¸ì„œ

## ğŸ“‹ ê°œìš”

Media Recommendation ServiceëŠ” AI ê¸°ë°˜ ì–¸ì–´ í•™ìŠµ í”Œë«í¼ "English Compass"ë¥¼ ìœ„í•œ ë¯¸ë””ì–´ ì¶”ì²œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ í•™ìŠµ ì„±ê³¼ì™€ ì„ í˜¸ ì¥ë¥´ë¥¼ ë¶„ì„í•˜ì—¬ ë§ì¶¤í˜• ë¯¸ë””ì–´ ì½˜í…ì¸ ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

- **Framework**: Spring Boot 3.x
- **Database**: H2 (ê°œë°œ), MySQL (ìš´ì˜)
- **Message Queue**: Apache Kafka
- **AI Service**: Google Gemini API
- **Port**: 8083

## ğŸ”— Base URL

```
http://localhost:8083
```

---

## ğŸ“š API ì—”ë“œí¬ì¸íŠ¸

### 1. ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜ ë¯¸ë””ì–´ ì¶”ì²œ ìƒì„±

ì‚¬ìš©ìê°€ ì„ íƒí•œ ì¥ë¥´ì™€ í•™ìŠµ ì„±ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§ì¶¤í˜• ë¯¸ë””ì–´ ì¶”ì²œì„ ìƒì„±í•©ë‹ˆë‹¤.

#### **POST** `/api/recommendations/user-requested`

**Request Body:**
```json
{
  "userId": 1,
  "selectedGenres": ["ì•¡ì…˜", "ìŠ¤ë¦´ëŸ¬", "SF", "íŒíƒ€ì§€"]
}
```

**Request Schema:**
| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… | ì œì•½ì¡°ê±´ |
|------|------|------|------|----------|
| `userId` | Long | âœ… | ì‚¬ìš©ì ID | ì–‘ìˆ˜ |
| `selectedGenres` | String[] | âœ… | ì„ íƒëœ ì¥ë¥´ ëª©ë¡ | 1-5ê°œ, ìœ íš¨í•œ ì¥ë¥´ëª… |

**Response (Success - 200):**
```json
{
  "status": "SUCCESS",
  "message": "ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜ ì¶”ì²œì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "totalRecommendations": 5,
  "selectedGenres": ["ì•¡ì…˜", "ìŠ¤ë¦´ëŸ¬", "SF", "íŒíƒ€ì§€"],
  "generatedAt": "2025-09-02T23:00:00",
  "recommendations": null
}
```

**Response (Error - 400):**
```json
{
  "status": "ERROR",
  "message": "ìµœì†Œ 1ê°œ ì´ìƒì˜ ì¥ë¥´ë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.",
  "totalRecommendations": 0,
  "generatedAt": "2025-09-02T23:00:00"
}
```

**Response (Error - 500):**
```json
{
  "status": "ERROR",
  "message": "ì¶”ì²œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: [ì˜¤ë¥˜ ìƒì„¸ ë‚´ìš©]",
  "totalRecommendations": 0,
  "generatedAt": "2025-09-02T23:00:00"
}
```

---

### 2. ì‚¬ìš© ê°€ëŠ¥í•œ ì¥ë¥´ ëª©ë¡ ì¡°íšŒ

ì¶”ì²œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¥ë¥´ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

#### **GET** `/api/recommendations/genres`

**Response (200):**
```json
{
  "genres": [
    "ì•¡ì…˜", "ë“œë¼ë§ˆ", "ì½”ë¯¸ë””", "ë¡œë§¨ìŠ¤", "ìŠ¤ë¦´ëŸ¬",
    "ê³µí¬", "ë¯¸ìŠ¤í„°ë¦¬", "SF", "íŒíƒ€ì§€", "ë²”ì£„",
    "ì „ìŸ", "ìŒì•…", "ì• ë‹ˆë©”ì´ì…˜", "ë‹¤íë©˜í„°ë¦¬"
  ],
  "message": "ì‚¬ìš© ê°€ëŠ¥í•œ ì¥ë¥´ ëª©ë¡ì…ë‹ˆë‹¤.",
  "totalCount": 14
}
```

---

### 3. ì‚¬ìš©ì ì¶”ì²œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ

íŠ¹ì • ì‚¬ìš©ìì˜ ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜ ì¶”ì²œ íˆìŠ¤í† ë¦¬ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

#### **GET** `/api/recommendations/user-requested/{userId}`

**Path Parameters:**
| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| `userId` | Long | âœ… | ì‚¬ìš©ì ID |

**Response (200):**
```json
{
  "status": "SUCCESS",
  "message": "ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜ ì¶”ì²œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì™„ë£Œ",
  "totalRecommendations": 0,
  "generatedAt": "2025-09-02T23:00:00"
}
```

---

### 4. í—¬ìŠ¤ ì²´í¬

ì„œë¹„ìŠ¤ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

#### **GET** `/actuator/health`

**Response (200):**
```json
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP"
    },
    "diskSpace": {
      "status": "UP"
    }
  }
}
```

---

## ğŸ­ ì¥ë¥´ ëª©ë¡

| ì¥ë¥´ | ì˜ì–´ëª… | ì„¤ëª… |
|------|--------|------|
| ì•¡ì…˜ | Action | ì•¡ì…˜ ì˜í™”/ë“œë¼ë§ˆ |
| ë“œë¼ë§ˆ | Drama | ë“œë¼ë§ˆ ì˜í™”/ë“œë¼ë§ˆ |
| ì½”ë¯¸ë”” | Comedy | ì½”ë¯¸ë”” ì˜í™”/ë“œë¼ë§ˆ |
| ë¡œë§¨ìŠ¤ | Romance | ë¡œë§¨ìŠ¤ ì˜í™”/ë“œë¼ë§ˆ |
| ìŠ¤ë¦´ëŸ¬ | Thriller | ìŠ¤ë¦´ëŸ¬ ì˜í™”/ë“œë¼ë§ˆ |
| ê³µí¬ | Horror | ê³µí¬ ì˜í™”/ë“œë¼ë§ˆ |
| ë¯¸ìŠ¤í„°ë¦¬ | Mystery | ë¯¸ìŠ¤í„°ë¦¬ ì˜í™”/ë“œë¼ë§ˆ |
| SF | Science Fiction | SF ì˜í™”/ë“œë¼ë§ˆ |
| íŒíƒ€ì§€ | Fantasy | íŒíƒ€ì§€ ì˜í™”/ë“œë¼ë§ˆ |
| ë²”ì£„ | Crime | ë²”ì£„ ì˜í™”/ë“œë¼ë§ˆ |
| ì „ìŸ | War | ì „ìŸ ì˜í™”/ë“œë¼ë§ˆ |
| ìŒì•… | Music | ìŒì•… ê´€ë ¨ ì½˜í…ì¸  |
| ì• ë‹ˆë©”ì´ì…˜ | Animation | ì• ë‹ˆë©”ì´ì…˜ ì˜í™”/ë“œë¼ë§ˆ |
| ë‹¤íë©˜í„°ë¦¬ | Documentary | ë‹¤íë©˜í„°ë¦¬ ì˜í™”/ë“œë¼ë§ˆ |

---

## ğŸ“Š ë°ì´í„° ëª¨ë¸

### UserRecommendationRequest
```json
{
  "userId": 1,
  "selectedGenres": ["ì•¡ì…˜", "ìŠ¤ë¦´ëŸ¬", "SF"]
}
```

### UserRecommendationResponse
```json
{
  "status": "SUCCESS|ERROR",
  "message": "ì‘ë‹µ ë©”ì‹œì§€",
  "totalRecommendations": 5,
  "selectedGenres": ["ì•¡ì…˜", "ìŠ¤ë¦´ëŸ¬", "SF"],
  "generatedAt": "2025-09-02T23:00:00",
  "recommendations": [
    {
      "id": 1,
      "title": "ì•¡ì…˜ ì˜í™” ì¶”ì²œ",
      "description": "ì˜ì–´ í•™ìŠµìš© ì•¡ì…˜ ì˜í™”",
      "url": "https://example.com/action-movie",
      "thumbnailUrl": "https://example.com/thumbnail.jpg",
      "playUrl": "https://example.com/embed/action-movie",
      "mediaType": "VIDEO",
      "platform": "Netflix",
      "difficultyLevel": "ì¤‘ê¸‰",
      "recommendationReason": "ë¹„ì¦ˆë‹ˆìŠ¤-íšŒì˜ ì¹´í…Œê³ ë¦¬ ì„±ê³¼ í–¥ìƒì„ ìœ„í•œ ì¶”ì²œ",
      "estimatedDuration": 120,
      "language": "en",
      "category": "ì•¡ì…˜",
      "videoId": "abc123",
      "channelName": "Netflix",
      "viewCount": "1.2M",
      "publishedAt": "2024-01-15",
      "generatedAt": "2025-09-02T23:00:00",
      "createdAt": "2025-09-02T23:00:00",
      "updatedAt": "2025-09-02T23:00:00"
    }
  ]
}
```

---

## ğŸ”„ ì¶”ì²œ ë¡œì§

### 1. ì‹¤ì‹œê°„ ì¶”ì²œ (í•™ìŠµ í›„ ì¶”ì²œ)
- **íŠ¸ë¦¬ê±°**: í•™ìŠµ ì„¸ì…˜ ì™„ë£Œ ì‹œ Kafka ì´ë²¤íŠ¸ ìˆ˜ì‹ 
- **ë°ì´í„°**: ì„¸ì…˜ ë¬¸ì œ ìƒì„¸ ì •ë³´, ëŒ€ë¶„ë¥˜/ì†Œë¶„ë¥˜
- **ì¶”ì²œ íƒ€ì…**: ì§§ì€ ìœ íŠœë¸Œ ë™ì˜ìƒ ìœ„ì£¼ (1-3ë¶„)
- **ëª©ì **: ë°©ê¸ˆ í‹€ë¦° ë¬¸ì œì˜ ì•½ì  ë³´ì™„

### 2. ì‚¬ìš©ì ìš”ì²­ ì¶”ì²œ
- **íŠ¸ë¦¬ê±°**: ì‚¬ìš©ìê°€ ë¯¸ë””ì–´ ì¶”ì²œ í˜ì´ì§€ì—ì„œ ì¥ë¥´ ì„ íƒ í›„ ìš”ì²­
- **ë°ì´í„°**: ì‚¬ìš©ì ì„±ê³¼ ë¶„ì„ (ì¹´í…Œê³ ë¦¬ë³„/ë‚œì´ë„ë³„), ì„ íƒëœ ì¥ë¥´
- **ì¶”ì²œ íƒ€ì…**: ë‹¤ì–‘í•œ ë¯¸ë””ì–´ (ìœ íŠœë¸Œ, ì˜í™”/ë“œë¼ë§ˆ, ì˜¤ë””ì˜¤ë¶)
- **ëª©ì **: ì „ë°˜ì ì¸ í•™ìŠµ ì„±ê³¼ í–¥ìƒ

---

## ğŸ“ˆ ì„±ê³¼ ë¶„ì„ ë°ì´í„°

### ì¹´í…Œê³ ë¦¬ë³„ ì„±ê³¼
- **ë°ì´í„° ì†ŒìŠ¤**: `category_performance_view`
- **ê³„ì‚° ë°©ì‹**: `(ì •ë‹µ ìˆ˜ / ì´ ë¬¸ì œ ìˆ˜) * 100`
- **ê·¸ë£¹í•‘**: `major_category + "-" + minor_category`
- **ì˜ˆì‹œ**: `{"ì—¬í–‰-ê°€ì¡±": 80.0, "ë¹„ì¦ˆë‹ˆìŠ¤-íšŒì˜": 65.0}`

### ë‚œì´ë„ë³„ ì„±ê³¼
- **ë°ì´í„° ì†ŒìŠ¤**: `difficulty_achievement_view`
- **ê³„ì‚° ë°©ì‹**: `(ì •ë‹µ ìˆ˜ / ì´ ë¬¸ì œ ìˆ˜) * 100`
- **ê·¸ë£¹í•‘**: `difficulty_level` (1: ì´ˆê¸‰, 2: ì¤‘ê¸‰, 3: ê³ ê¸‰)
- **ì˜ˆì‹œ**: `{1: 90.0, 2: 75.0, 3: 45.0}`

---

## âš ï¸ ì˜¤ë¥˜ ì½”ë“œ

| HTTP Status | ì˜¤ë¥˜ ìœ í˜• | ì„¤ëª… |
|-------------|-----------|------|
| 400 | Bad Request | ì˜ëª»ëœ ìš”ì²­ ë°ì´í„° (ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨) |
| 500 | Internal Server Error | ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ (DB ì—°ê²° ì‹¤íŒ¨, AI API ì˜¤ë¥˜ ë“±) |

---



## ğŸ“ ì‚¬ìš© ì˜ˆì‹œ

### 1. ì¥ë¥´ ëª©ë¡ ì¡°íšŒ
```bash
curl -X GET http://localhost:8083/api/recommendations/genres
```

### 2. ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜ ì¶”ì²œ ìƒì„±
```bash
curl -X POST http://localhost:8083/api/recommendations/user-requested \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "selectedGenres": ["ì•¡ì…˜", "ìŠ¤ë¦´ëŸ¬", "SF"]
  }'
```

### 3. ì¶”ì²œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ
```bash
curl -X GET http://localhost:8083/api/recommendations/user-requested/1
```

---


